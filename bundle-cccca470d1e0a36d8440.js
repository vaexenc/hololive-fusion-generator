(()=>{var t={290:()=>{!function(){const t=document.createElement("meta");t.name="darkreader",t.content="NO-DARKREADER-PLUGIN";const e=function(){!function(){document.querySelector('meta[content="'+t.content+'"]')||document.head.appendChild(t);let e=document.querySelector('meta[name="'+t.name+'"]');e&&e.content!=t.content&&e.remove()}(),function(){for(const t of document.head.getElementsByClassName("darkreader"))t.remove()}()},n=new MutationObserver(e);!document.querySelector('meta[content="'+t.content+'"]')&&document.querySelector('meta[name="'+t.name+'"]')?console.error("Please add the line bellow to your index.html:\n",'<meta name="darkreader" content="NO-DARKREADER-PLUGIN">\n',"or you may encounter a performance issue!\n","\nplease take a look at: https://github.com/hadialqattan/no-darkreader#usage"):(n.observe(document.head,{attributes:!1,childList:!0,subtree:!1}),e())}()},780:t=>{t.exports={backgroundImages:["bg0.webp","bg1.webp","bg2.webp","bg3.webp","bg4.webp","bg5.webp","bg6.webp","bg7.webp","bg8.webp","bg9.webp","bg10.webp","bg11.webp","bg12.webp","bg13.webp","bg14.webp","bg15.webp","bg16.webp","bg17.webp","bg18.webp","bg19.webp","bg20.webp","bg21.webp","bg22.webp","bg23.webp","bg24.webp","bg25.webp","bg26.webp","bg27.webp"]}},660:(t,e,n)=>{const o=n(156),a=n(641),r="last",i="first";function s(t){return t[0].toUpperCase()+t.slice(1)}function c(t,e){return function(t,e){return t.slice(-1).toLowerCase()===e[0].toLowerCase()}(t,e)?t.slice(0,-1)+e:t+e}function f(t){return t||"undefined"}function u(t,e,n){return function(t,e,n,o){const a=c(t,e);return a===n||a===o?c(t,o):a}(t.name[n+"Before"],e.name[n+"After"],t.name[n],e.name[n])}function d(t,e,n){return t.name[n]&&e.name[n]?u(t,e,n):t.name[n]||e.name[n]}function l(t,e){if(t===e)return function(t){return{last:s(t.name.last),first:s(t.name.first)}}(t);const n=function(t,e){const n=function(t,e){return t.id+" "+e.id}(t,e);if(n in o)return o[n]}(t,e);return n||{last:d(t,e,r),first:d(t,e,i)}}function h(t){const e=[];for(const n of["last","first"])t[n]&&e.push(s(t[n]));return e.join(" ")}function y(t){return s(f(t.lastName))+" "+s(f(t.firstName))}function g(t,e){return[{talent1:t,talent2:e,fusion:l(t,e)},{talent1:e,talent2:t,fusion:l(e,t)}]}function m(t,e,n){const o=y(t),a=y(e),r=y(n);console.log(o+" + "+a+" = "+r)}t.exports={getFullNameStringById:function(t){return h(a.getTalentById(t).name)},getFusionStringByIds:function(t,e){return h(function(t,e){return l(a.getTalentById(t),a.getTalentById(e))}(t,e))},printAllNameVariations:function(){const t=function(){const t=[],e=a.getTalentIdsAll();for(let n=0;n<e.length;n++)for(let o=n+1;o<e.length;o++){const r=a.getTalentById(e[n]),i=a.getTalentById(e[o]);t.push(...g(r,i))}return t}();for(const e of t)m(e.talent1,e.talent2,e.fusion)},printAllNameVariationsForTalent:function(t){const e=function(t){const e=[],n=a.getTalentIdsAll();for(const o of n){if(t===o)continue;const n=a.getTalentById(t),r=a.getTalentById(o);e.push(...g(n,r))}return e}(t);for(const t of e)m(t.talent1,t.talent2,t.fusion)}}},641:(t,e,n)=>{const o=n(267),a=n(643);function r(){return a.getObjectLength(o)}function i(){return Object.entries(o).filter((t=>t[1].enabled)).map((t=>t[0]))}function s(){return i().length}t.exports={calculateTalentVariationsAll:function(){return a.calculateVariations(r())},calculateTalentVariationsEnabled:function(){return a.calculateVariations(s())},getTalentById:function(t){const e=o[t];if(!e)throw new Error("talent not found");return e},getTalentCountAll:r,getTalentCountEnabled:s,getTalentIdsAll:function(){return Object.keys(o)},getTalentIdsEnabled:i}},643:t=>{function e(t){return Math.floor(t*Math.random())}t.exports={calculateVariations:function(t){return t*t-t},getObjectLength:function(t){return Object.keys(t).length},getRandomInt:e,getRandomIntUnique:function(t,n){"number"==typeof n&&(n=[n]);let o=n[0];for(;n.includes(o);)o=e(t);return o},mod:function(t,e){return(t%e+e)%e}}},156:t=>{"use strict";t.exports=JSON.parse('{"calli kiara":{"last":"morinashi","first":"clara"},"kiara calli":{"last":"takamori","first":"killiope"},"ame ina":{"last":"wahtson","first":"ame\'nis"},"ame gura":{"last":"watsogawr","first":"amesame"},"gura ame":{"last":"gawrtson","first":"gurame"}}')},267:t=>{"use strict";t.exports=JSON.parse('{"sora":{"id":"sora","enabled":true,"name":{"last":"tokino","first":"sora","lastBefore":"toki","lastAfter":"kino","firstBefore":"so","firstAfter":"ora"},"draw":{"first":{"hair":{"colors":["#865147","#bc8875","#c2967e"]},"body":{"colors":["#868ef8","#503aa4","#fc2a73","#ffffff"]},"etc":{"colors":["#fc2a73","#fefdcc"]},"mouth":{"x":0.48444444444444446,"y":0.5079365079365079,"width":0.9333333333333333,"hasSub":true,"hasAdd":true},"nose":{"x":0.5299145299145299,"y":0.5912408759124088,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.12,"xRight":0.9276485788113695,"y":0.5174825174825175}},"second":{"hair":{"count":1},"body":{"count":2},"etc":{"count":2},"mouth":{"y":0.598,"width":0.06},"nose":{"y":0.545},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.046,"width":0.091,"y":0.48},"faceCenterX":0.38,"rotation":-10.71,"unitinu":{"faceChinY":0.63}}}},"fubuki":{"id":"fubuki","enabled":true,"name":{"last":"shirakami","first":"fubuki","lastBefore":"shira","lastAfter":"kami","firstBefore":"fubu","firstAfter":"buki"},"draw":{"first":{"hair":{"colors":["#fffffa","#ede8e6","#3b373b"]},"body":{"colors":["#fffffa","#a2e1ff","#3c383c"]},"etc":{"colors":["#c2b4aa"]},"mouth":{"x":0.5,"y":0.7777,"width":0.92,"hasSub":true},"nose":{"x":0.4626865671641791,"y":0.8210526315789474,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.155,"xRight":0.92,"y":0.5}},"second":{"hair":{"count":2},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.4554118447923758,"width":0.044},"nose":{"y":0.3951667801225323},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.038,"width":0.068,"y":0.3573859768550034},"faceCenterX":0.5,"unitinu":{"faceChinY":0.5010211027910143}}}},"haato":{"id":"haato","enabled":true,"name":{"last":"akai","first":"haato","lastBefore":"aka","lastAfter":"kai","firstBefore":"haa","firstAfter":"aato"},"draw":{"first":{"hair":{"colors":["#ffe3ae","#f9d3a7"]},"body":{"colors":["#3d70b8","#de445d","#fffffd"]},"etc":{"colors":["#de445d","#3d70b8","#ffdb90"]},"mouth":{"x":0.47651006711409394,"y":0.6875,"width":0.8590604026845637,"hasSub":true},"nose":{"x":0.711864406779661,"y":0.525,"hasSub":true,"hasAdd":true},"eyes":{"areDifferent":false,"xLeft":0.095,"xRight":0.94,"y":0.49523809523809526}},"second":{"hair":{"count":2},"body":{"count":2},"etc":{"count":2},"mouth":{"y":0.3785,"width":0.043},"nose":{"y":0.339},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.041,"width":0.077,"y":0.29},"faceCenterX":0.488,"rotation":-1.6,"unitinu":{"faceChinY":0.47}}}},"okayu":{"id":"okayu","enabled":true,"name":{"last":"nekomata","first":"okayu","lastBefore":"neko","lastAfter":"mata","firstBefore":"oka","firstAfter":"kayu"},"draw":{"first":{"hair":{"colors":["#f7e8ff","#e7c6ff"]},"body":{"colors":["#787d80","#d36aed","#3a383d"]},"etc":{"colors":["#d391e8","#ffffff","#353535"]},"mouth":{"x":0.49056603773584906,"y":0.4,"width":1.1,"hasCutout":true,"hasSub":true,"hasAdd":true},"nose":{"x":0.4642857142857143,"y":0.8518518518518519,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.14,"xRight":0.91,"y":0.5402298850574713}},"second":{"hair":{"count":1},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.448,"width":0.047},"nose":{"y":0.3980836236933798},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.044,"width":0.087,"y":0.356},"faceCenterX":0.4991289198606272,"unitinu":{"faceChinY":0.5121951219512195}}}},"korone":{"id":"korone","enabled":true,"name":{"last":"inugami","first":"korone","lastBefore":"inu","lastAfter":"gami","firstBefore":"koro","firstAfter":"rone"},"draw":{"first":{"hair":{"colors":["#a6706a","#844d45","#d39c94"]},"body":{"colors":["#fae79a","#ec5f7a","#7ec9d5","#d1d8d5"]},"etc":{"colors":["#ec5f7a","#7ec9d5"]},"mouth":{"x":0.5076923076923077,"y":0.4,"width":0.8615384615384616,"hasSub":true,"hasAdd":true},"nose":{"x":0.4523809523809524,"y":0.8285714285714286,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.11,"xRight":0.89,"y":0.49206349206349204}},"second":{"hair":{"count":1},"body":{"count":2},"etc":{"count":3},"mouth":{"y":0.376,"width":0.051},"nose":{"y":0.342},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.038,"width":0.065,"y":0.283},"faceCenterX":0.5,"unitinu":{"faceChinY":0.431}}}},"pekora":{"id":"pekora","enabled":true,"name":{"last":"usada","first":"pekora","lastBefore":"usa","lastAfter":"sada","firstBefore":"peko","firstAfter":"kora"},"draw":{"first":{"hair":{"colors":["#acc0f2","#ffffff","#5f6aaf","#bdbdd7"]},"body":{"colors":["#ffffff","#4375f5","#a0cdfb","#dce5f1"]},"etc":{"colors":["#ff8437","#4375f5","#a0cdfb"]},"mouth":{"x":0.509090909090909,"y":0.32,"width":0.7,"hasCutout":true,"hasSub":true,"hasAdd":true},"nose":{"x":0.5,"y":0.6867469879518072,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.16,"xRight":0.89,"y":0.49044585987261147}},"second":{"hair":{"count":2},"body":{"count":3},"mouth":{"y":0.522,"width":0.045},"nose":{"y":0.48433333333333334},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.033,"width":0.055,"y":0.44666666666666666},"faceCenterX":0.5,"unitinu":{"faceChinY":0.5633333333333334}}}},"coco":{"id":"coco","enabled":true,"name":{"last":"kiryu","first":"coco","lastBefore":"ki","lastAfter":"ryu","firstBefore":"coco","firstAfter":"coco"},"draw":{"first":{"hair":{"colors":["#fd945e","#fcfa60","#552039"]},"body":{"colors":["#645a67","#a23f60","#fef6f3","#b92934","#f4af48"]},"etc":{"colors":["#c10417","#574fb9","#fccf54"]},"mouth":{"x":0.472,"y":0.42105263157894735,"width":0.864,"hasSub":true},"nose":{"x":0.46875,"y":0.5681818181818182,"hasSub":true,"hasAdd":true},"eyes":{"areDifferent":false,"xLeft":0.2,"xRight":0.8976744186046511,"y":0.5}},"second":{"hair":{"count":3},"body":{"count":3},"etc":{"count":3},"mouth":{"y":0.373,"width":0.047},"nose":{"y":0.3365},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.036,"width":0.063,"y":0.287},"faceCenterX":0.5,"areEyesOnTop":true,"unitinu":{"faceChinY":0.4145}}}},"ollie":{"id":"ollie","enabled":true,"name":{"last":"kureiji","first":"ollie","lastBefore":"kurei","lastAfter":"reiji","firstBefore":"olli","firstAfter":"llie"},"draw":{"first":{"hair":{"colors":["#eb0045","#edb7c7","#d1c6ca"]},"body":{"colors":["#465666","#de2545","#aaa2b9","#d4b0ba"]},"etc":{"colors":["#db2443","#aaa2b9","#d4b0ba"]},"mouth":{"x":0.4954128440366973,"y":0.41,"width":0.7,"hasCutout":true},"nose":{"x":0.48936170212765956,"y":0.8769230769230769,"hasSub":true},"eyes":{"areDifferent":true,"xLeft":0.22,"xRight":0.93,"y":0.5418994413407822}},"second":{"hair":{"count":3},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.59,"width":0.0646},"nose":{"y":0.530932594644506},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.05216989843028624,"width":0.091,"y":0.46722068328716526},"faceCenterX":0.4995383194829178,"unitinu":{"faceChinY":0.6611265004616805}}}},"anya":{"id":"anya","enabled":true,"name":{"last":"melfissa","first":"anya","lastBefore":"melfi","lastAfter":"fissa","firstBefore":"an","firstAfter":"nya"},"draw":{"first":{"hair":{"colors":["#99797e","#f8d176","#bf977a","#f6b575"]},"body":{"colors":["#61637c","#f8d176","#9a7e90"]},"etc":{"colors":["#f8d176","#61637c","#9a7e90","#cec8bc"]},"mouth":{"x":0.5328947368421053,"y":0.85,"width":0.868421052631579,"hasSub":true},"nose":{"x":0.5,"y":0.375,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.11,"xRight":0.92,"y":0.32}},"second":{"hair":{"count":2},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.5525378450578807,"width":0.0675},"nose":{"y":0.4866429207479964},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.055,"width":0.109,"y":0.43766696349065004},"faceCenterX":0.5031166518254675,"unitinu":{"faceChinY":0.6148708815672307}}}},"calli":{"id":"calli","enabled":true,"name":{"last":"mori","first":"calliope","lastBefore":"mori","lastAfter":"mori","firstBefore":"calli","firstAfter":"lliope"},"draw":{"first":{"hair":{"colors":["#f8ccde","#e48096"]},"body":{"colors":["#302c2c","#9b7f6c"]},"etc":{"colors":["#ca1748","#f68d9f"]},"mouth":{"x":0.47668393782383417,"y":0.2871287128712871,"width":0.8497409326424871,"hasSub":true},"nose":{"x":0.4827586206896552,"y":0.5397727272727273,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.15,"xRight":0.91,"y":0.5638297872340425}},"second":{"hair":{"count":1},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.5416991426344505,"width":0.0646921278254092},"nose":{"y":0.49727201870615745},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.0535,"width":0.0925,"y":0.4247856586126267},"faceCenterX":0.49571317225253314,"unitinu":{"faceChinY":0.6137957911145752}}}},"kiara":{"id":"kiara","enabled":true,"name":{"last":"takanashi","first":"kiara","lastBefore":"taka","lastAfter":"nashi","firstBefore":"kia","firstAfter":"ara"},"draw":{"first":{"hair":{"colors":["#ff8161","#bdead7","#63b8d6"]},"body":{"colors":["#fd622a","#393e78","#ffffff","#f2270a"]},"etc":{"colors":["#69ebc9","#e0f962","#febc6e"]},"mouth":{"x":0.49382716049382713,"y":0.6590909090909091,"width":0.9135802469135802,"hasSub":true,"hasAdd":true},"nose":{"x":0.4,"y":0.6530612244897959,"hasSub":true,"hasAdd":true},"eyes":{"areDifferent":false,"xLeft":0.14583333333333334,"xRight":0.95,"y":0.5103448275862069}},"second":{"hair":{"count":3},"body":{"count":3},"etc":{"count":3},"mouth":{"y":0.5395014786649768,"width":0.06252640473172792},"nose":{"y":0.4816223067173637},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.051964512040557666,"width":0.084,"y":0.4224757076468103},"faceCenterX":0.5006337135614702,"unitinu":{"faceChinY":0.6037177862272919}}}},"ina":{"id":"ina","enabled":true,"name":{"last":"ninomae","first":"ina\'nis","lastBefore":"nino","lastAfter":"mae","firstBefore":"ina","firstAfter":"\'nis"},"draw":{"first":{"hair":{"colors":["#695982","#f3a35f","#50445e","#ffba76"]},"body":{"colors":["#554d5f","#876b9c","#e8e4ed"]},"etc":{"colors":["#a94665","#ad6ca2","#e8e4ed"]},"mouth":{"x":0.46153846153846156,"y":0.36,"width":1.2,"hasSub":true,"hasAdd":true},"nose":{"x":0.48717948717948717,"y":0.7246376811594203,"hasSub":true,"hasAdd":true},"eyes":{"areDifferent":false,"xLeft":0.16037735849056603,"xRight":0.9716981132075472,"y":0.5}},"second":{"hair":{"count":3},"body":{"count":3},"etc":{"count":1},"mouth":{"y":0.5663538873994638,"width":0.04},"nose":{"y":0.524798927613941},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.036193029490616625,"width":0.062,"y":0.48525469168900803},"faceCenterX":0.5013404825737265,"unitinu":{"faceChinY":0.6065683646112601}}}},"gura":{"id":"gura","enabled":true,"name":{"last":"gawr","first":"gura","lastBefore":"gawr","lastAfter":"gawr","firstBefore":"gu","firstAfter":"ra"},"draw":{"first":{"hair":{"colors":["#f3f3f3","#5e9ad2","#e2e3e5","#afebe3"]},"body":{"colors":["#33739d","#b3b3b3","#ffffff"]},"etc":{"colors":["#64a4cb","#b3b3b3","#ffffff"]},"mouth":{"x":0.4895833333333333,"y":0.9090909090909091,"width":1,"hasSub":true},"nose":{"x":0.47619047619047616,"y":0.6166666666666667,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.052434456928838954,"xRight":0.9737827715355806,"y":0.5}},"second":{"hair":{"count":2},"body":{"count":2},"mouth":{"y":0.5696252465483235,"width":0.0757396449704142},"nose":{"y":0.5088757396449705},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.05798816568047337,"width":0.09861932938856016,"y":0.44260355029585796},"faceCenterX":0.49940828402366866,"unitinu":{"faceChinY":0.6378698224852071}}}},"ame":{"id":"ame","enabled":true,"name":{"last":"watson","first":"amelia","lastBefore":"watso","lastAfter":"tson","firstBefore":"ame","firstAfter":"melia"},"draw":{"first":{"hair":{"colors":["#fad99b","#f4cb94"]},"body":{"colors":["#fae5cd","#8f5048","#f2f0f3","#ea4f5f"]},"etc":{"colors":["#ea4f5f","#f2c8ca"]},"mouth":{"x":0.5,"y":0.4,"width":0.95,"hasCutout":true,"hasSub":true},"nose":{"x":0.5571428571428572,"y":0.7647058823529411,"hasSub":true},"eyes":{"areDifferent":false,"xLeft":0.2,"xRight":0.92,"y":0.543}},"second":{"hair":{"count":2},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.5623130608175474,"width":0.06580259222333001},"nose":{"y":0.4945164506480558},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.0575,"width":0.105,"y":0.42572283150548357},"faceCenterX":0.5423728813559322,"unitinu":{"faceChinY":0.638085742771685}}}}}')}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}(()=>{"use strict";const t=document.querySelector.bind(document);function e(t){return t.content.cloneNode(!0)}var o=n(643),a=n(660),r=n(641);const i="images/talents/",s=".webp",c=["hair","body","etc"],f=["topLeft","topRight","bottomLeft","bottomRight"],u=m(6);function d(t){const e=new Image;return e.src=t,e}function l(t){return new Promise((e=>{t.onload=()=>e(t)}))}function h(t,e){e.push(l(t))}function y(t){if(t.length<=1)return;const{width:e,height:n}=t[0];for(const o of t)if(o.width!==e||o.height!==n)throw new Error("images are of different sizes")}function g(t,e){return t/e}function m(t){return t*Math.PI/180}function b(t,e,n){return{width:t,height:n*(t/e)}}function w(t,e,n,o){return a=t,r=e,g(n,o)>g(a,r)?b(t,n,o):{width:n*((i=e)/o),height:i};var a,r,i}function p(t,e,n){return function(t,e,n){return t*(1-n)+e*n}(0,t-e,n)}function x(t){const e=t.getContext("2d");e.save(),e.fillStyle="white",e.fillRect(0,0,t.width,t.height),e.restore()}function k(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e}function C(t,e,n,o){y(Object.values(e.eyes));const a=e.baseImage,r=a.width*o.faceCenterX,i=e.eyes.left||e.eyes.right,s=i.width*(n.eyes.xRight-n.eyes.xLeft),c=a.width*o.eyes.width/s,f=a.width*o.eyes.faceCenterXToEyeDistance,u=b(c*i.width,i.width,i.height),d=a.height*o.eyes.y-u.height*n.eyes.y,l=o.eyes.sides;if("both"===l||"left"===l){const e=r-f-u.width*n.eyes.xRight;t.drawImage(i,e,d,u.width,u.height)}if("both"===l||"right"===l){const o=e.eyes.right||e.eyes.left,i=a.width-r-f-u.width*n.eyes.xRight;t.save(),t.translate(a.width,0),t.scale(-1,1),t.drawImage(o,i,d,u.width,u.height),t.restore()}}function I(t){const e=function(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e}(t),n=e.getContext("2d");return n.translate(t.width,0),n.scale(-1,1),n.drawImage(t,0,0),e}function L(t,e,n,o){return Math.sqrt((t-n)**2+(e-o)**2)}function S(t,e,n,o){return Math.atan2(o-e,n-t)}function R(t,e,n,o){return{x:o*Math.cos(n)+t,y:o*Math.sin(n)+e}}function A(t){let e=1/0,n=-1/0,o=1/0,a=-1/0;for(const r of f)e=Math.min(e,t[r].x),n=Math.max(n,t[r].x),o=Math.min(o,t[r].y),a=Math.max(a,t[r].y);return{left:e,right:n,top:o,bottom:a,width:n-e,height:a-o}}function T(t,e,n){for(const o of f)e&&(t[o].x+=e),n&&(t[o].y+=n)}function v(t,e){const n=e/A(t).height,o=function(t){return S(t.topLeft.x,t.topLeft.y,t.topRight.x,t.topRight.y)}(t),a=L(t.topLeft.x,t.topLeft.y,t.topRight.x,t.topRight.y),r=L(t.topLeft.x,t.topLeft.y,t.bottomLeft.x,t.bottomLeft.y),i={x:0,y:0},s=R(i.x,i.y,o,a*n),c={topLeft:i,topRight:s,bottomLeft:R(i.x,i.y,o+Math.PI/2,r*n),bottomRight:R(s.x,s.y,o+Math.PI/2,r*n)};return T(c,0,-A(c).top),c}function B(t,e){const n=((e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1))/((e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1)),o=((t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1))/((e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1));return n>=0&&n<=1&&o>=0&&o<=1?{intersectionX:t.x1+n*(t.x2-t.x1),intersectionY:t.y1+n*(t.y2-t.y1)}:null}function E(t,e,n){return R(e.x,e.y,S(e.x,e.y,t.x,t.y)+n,L(e.x,e.y,t.x,t.y))}function D(t,e,n,o){const a=t.width/2,r=t.height,i={x:0,y:0},s=R(i.x,i.y,o,a),c=v({topLeft:i,topRight:s,bottomLeft:R(i.x,i.y,o+Math.PI/2,r),bottomRight:R(s.x,s.y,o+Math.PI/2,r)},t.height);T(c,-1e6);const f=function(t,e){const n=[];return n.push(B(t,{x1:e.topLeft.x,y1:e.topLeft.y,x2:e.topRight.x,y2:e.topRight.y})),n.push(B(t,{x1:e.topRight.x,y1:e.topRight.y,x2:e.bottomRight.x,y2:e.bottomRight.y})),n.push(B(t,{x1:e.bottomRight.x,y1:e.bottomRight.y,x2:e.bottomLeft.x,y2:e.bottomLeft.y})),n.push(B(t,{x1:e.bottomLeft.x,y1:e.bottomLeft.y,x2:e.topLeft.x,y2:e.topLeft.y})),n.filter((t=>Boolean(t)))}({x1:e,y1:n,x2:-1e6,y2:n},c);let u=1/0;for(const t of f)u=Math.min(u,L(e,n,t.intersectionX,t.intersectionY));T(c,u);const d=L(0,0,t.width,t.height),l=document.createElement("canvas");l.width=d,l.height=d;const h=l.getContext("2d");x(l),h.drawImage(t,(d-t.width)/2,(d-t.height)/2);const y=document.createElement("canvas");y.width=d,y.height=d;const g=y.getContext("2d");g.translate(d/2,d/2),g.rotate(-o),g.translate(-t.width/2,-t.height/2),g.drawImage(t,0,0),T(c,(d-t.width)/2,(d-t.height)/2);const m=document.createElement("canvas");m.width=a,m.height=r;const b=m.getContext("2d"),w=E({x:c.topLeft.x,y:c.topLeft.y},{x:y.width/2,y:y.height/2},-o);return b.drawImage(y,w.x,w.y,L(c.topLeft.x,c.topLeft.y,c.topRight.x,c.topRight.y),L(c.topLeft.x,c.topLeft.y,c.bottomLeft.x,c.bottomLeft.y),0,0,m.width,m.height),m}function q(t,e,n,o){return D(I(t),t.width-e,n,o)}function X(t,e,n,o,a){if("none"===e.side)return;let r;r="up"===e.angled?-1*u:"down"===e.angled?u:0,a||(a=0);const{x:i,y:s}=E({x:n,y:o},{x:0,y:0},m(a));let c;return c="left"===e.side?D:q,function(t){const e=document.createElement("canvas");e.width=2*t.width,e.height=t.height;const n=e.getContext("2d");return n.drawImage(t,0,0),n.translate(e.width,0),n.scale(-1,1),n.drawImage(t,0,0),e}(c(t,i,s,r))}async function O(t,e,n){const o=document.createElement("canvas");if(t===e){const e=await async function(t,e){const n=d(i+e+"-original"+s);return await l(n),t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0),t}(o,t);if("none"!==n.side){const o=(0,r.getTalentById)(t).draw.second;return X(e,n,e.width*o.faceCenterX,e.height*o.unitinu.faceChinY,o.rotation)}return e}const a=o.getContext("2d"),f=await async function(t,e){const n=(0,r.getTalentById)(t).draw.first,o=(0,r.getTalentById)(e).draw.second,a={},f=[],u=d(i+e+"-base"+s);if(a.baseImage=u,h(u,f),n.mouth&&o.mouth){if(a.mouth={},n.mouth.hasSub){const e=d(i+t+"-mouth-blend-sub"+s);a.mouth.sub=e,h(e,f)}if(n.mouth.hasAdd){const e=d(i+t+"-mouth-blend-add"+s);a.mouth.add=e,h(e,f)}if(n.mouth.hasCutout){const e=d(i+t+"-mouth-cutout"+s);a.mouth.cutout=e,h(e,f)}}if(n.nose&&o.nose){if(a.nose={},n.nose.hasSub){const e=d(i+t+"-nose-sub"+s);a.nose.sub=e,h(e,f)}if(n.nose.hasAdd){const e=d(i+t+"-nose-add"+s);a.nose.add=e,h(e,f)}}if(n.eyes&&o.eyes){const e=o.eyes.sides;if(a.eyes={},!n.eyes.areDifferent||"right"!==e){const e=d(i+t+"-eye-left"+s);a.eyes.left=e,h(e,f)}if(n.eyes.areDifferent&&("both"===e||"right"===e)){const e=d(i+t+"-eye-right"+s);a.eyes.right=e,h(e,f)}}for(const t of c)if(n[t]&&o[t]){a[t]=[];for(let n=0;n<o[t].count;n++){const o=d(i+e+"-"+t+"-"+n+s);a[t].push(o),h(o,f)}}return await Promise.all(f),a}(t,e),u=(0,r.getTalentById)(t).draw.first,g=(0,r.getTalentById)(e).draw.second,w=f.baseImage,p=[];for(const t of c)if(f[t])for(const e of f[t])p.push(e);y(p.concat([w])),o.width=w.width,o.height=w.height;const x=k(o),I=x.getContext("2d");I.drawImage(w,0,0),I.globalCompositeOperation="saturation",I.fillStyle="black",I.fillRect(0,0,x.width,x.height);const L=k(o),S=L.getContext("2d");for(const t of p)S.drawImage(t,0,0);I.globalCompositeOperation="destination-in",I.drawImage(L,0,0),a.drawImage(w,0,0),a.drawImage(x,0,0);const R=w.width*g.faceCenterX,A=g.rotation;if(function(t,e){e&&(t.save(),t.rotate(m(e)))}(a,A),f.mouth){y(Object.values(f.mouth));const t=f.mouth.sub||f.mouth.add||f.mouth.cutout,e=t.width*u.mouth.width,n=w.width*g.mouth.width,o=w.height*g.mouth.y,r=n/e,i=b(r*t.width,t.width,t.height),s=R-i.width*u.mouth.x,c=o-i.height*u.mouth.y;if(f.mouth.sub&&(a.save(),a.globalCompositeOperation="difference",a.drawImage(f.mouth.sub,s,c,i.width,i.height),a.restore()),f.mouth.add&&(a.save(),a.globalCompositeOperation="lighter",a.drawImage(f.mouth.add,s,c,i.width,i.height),a.restore()),f.mouth.cutout&&a.drawImage(f.mouth.cutout,s,c,i.width,i.height),f.nose){y(Object.values(f.nose));const t=f.nose.sub||f.nose.add,e=w.height*g.nose.y,n=b(r*t.width,t.width,t.height),o=R-n.width*u.nose.x,i=e-n.height*u.nose.y;f.nose.add&&(a.save(),a.globalCompositeOperation="lighter",a.drawImage(f.nose.add,o,i,n.width,n.height),a.restore()),f.nose.sub&&(a.save(),a.globalCompositeOperation="difference",a.drawImage(f.nose.sub,o,i,n.width,n.height),a.restore())}}f.eyes&&!g.areEyesOnTop&&C(a,f,u,g),function(t,e){e&&t.restore()}(a,A);for(const t of c)if(f[t])for(const[e,n]of f[t].entries()){a.save();const r=u[t].colors[e%u[t].colors.length],i=k(o),s=i.getContext("2d");s.drawImage(n,0,0),s.fillStyle=r,s.globalCompositeOperation="overlay",s.fillRect(0,0,i.width,i.height),s.globalCompositeOperation="destination-in",s.drawImage(n,0,0),a.drawImage(i,0,0),a.restore()}return f.eyes&&g.areEyesOnTop&&C(a,f,u,g),"none"!==n.side?X(o,n,R,w.height*g.unitinu.faceChinY,A):o}let M=0;var _=n(780);let Y;function P(){localStorage.removeItem("backgroundIndex")}function N(e){Y=e,t(".background").style.setProperty("--image-url",`url(images/backgrounds/${_.backgroundImages[e]})`)}function j(){localStorage.setItem("backgroundIndex",Y)}function U(t){return(0,o.mod)(t,_.backgroundImages.length)}function H(){const t=function(){const t=localStorage.getItem("backgroundIndex");if("string"==typeof t&&t.match(/^\d+/))return parseInt(t)}();var e;"number"!=typeof(e=t)||e<0||e>=_.backgroundImages.length?(N((0,o.getRandomInt)(_.backgroundImages.length)),P()):N(t)}function V(){t(".info").classList.remove("info--in"),t(".info").classList.add("info--out")}function $(){const e=t(".info").classList;t(".info-button").onclick=n=>{e.contains("info--in")||(t(".info").classList.remove("info--out"),t(".info").classList.add("info--in"),n.stopPropagation())},window.onkeydown=t=>{e.contains("info--in")&&"Escape"===t.key&&V()},window.onclick=()=>{e.contains("info--in")&&V()},t(".info__close").onclick=()=>{V()},t(".info").onclick=t=>{t.stopPropagation()},t(".background-forwards").onclick=()=>(Y=U(++Y),N(Y),void j()),t(".background-backwards").onclick=()=>(Y=U(--Y),N(Y),void j()),t(".background-random").onclick=()=>(N((0,o.getRandomIntUnique)(_.backgroundImages.length,Y)),void P()),t(".current-progress").innerHTML=(0,r.getTalentCountEnabled)(),t(".possible-variations").innerHTML=(0,r.calculateTalentVariationsEnabled)()}n(290);const F=[{side:"none",angled:"none"},{side:"left",angled:"none"},{side:"left",angled:"up"},{side:"left",angled:"down"},{side:"right",angled:"none"},{side:"right",angled:"up"},{side:"right",angled:"down"}],J=(0,r.getTalentIdsEnabled)(),G=[];let K=0;function z(t){return(0,o.mod)(t,J.length)}function W(t){return parseInt(t.dataset.talentIndex)}function Q(t,e){t.dataset.talentIndex=e}function Z(){return[J[W(G[0])],J[W(G[1])]]}function tt(t){return t.closest(".talent-select-container")}function et(t){Q(t,z(W(t)-1)),gt()}function nt(t){Q(t,z(W(t)+1)),gt()}function ot(t){et(tt(t.target))}function at(t){nt(tt(t.target))}function rt(t){if(J.length<=1)return;const e=W(t);let n;if(2===J.length)n=z(e+1);else{const a=W(function(t){return t===G[0]?G[1]:G[0]}(t));n=(0,o.getRandomIntUnique)(J.length,[e,a])}Q(t,n),gt()}function it(t){rt(tt(t.target))}function st(){if(J.length<=1)return;const t=W(G[0]),e=(0,o.getRandomIntUnique)(J.length,t),n=W(G[1]);let a=n;a=2===J.length?z(e+1):(0,o.getRandomIntUnique)(J.length,[n,e]),Q(G[0],e),Q(G[1],a),gt()}function ct(){const t=W(G[0]),e=W(G[1]);Q(G[0],e),Q(G[1],t),gt()}function ft(t,e){!function(t){for(const e of[...t.classList])e.startsWith("unitinu-")&&t.classList.remove(e)}(t),function(t,e){t.classList.add("unitinu-side-"+e.side),t.classList.add("unitinu-angled-"+e.angled)}(t,e)}function ut(){K=(K+1)%F.length,ft(t(".button-img-unitinu-container"),F[K]),ft(t(".result-name-container"),F[K]),gt()}function dt(){!function(){const n=t(".template-talent-select");for(let o=1;o<=2;o++){const a=e(n);a.querySelector(".talent-select-container").classList.add(`talent-select-container-${o}`),a.querySelector(".talent-select-box").classList.add(`talent-select-box-${o}`),a.querySelector(".talent-dropdown").classList.add(`talent-dropdown-${o}`),t("main").appendChild(a)}}(),function(){const e=(0,o.getRandomInt)(J.length);for(let n=0;n<2;n++){const o=t(`.talent-select-container-${n+1}`);Q(o,e),o.querySelector(".talent-select-image").onclick=It,o.querySelector(".talent-select-name__name").onclick=It,o.querySelector(".button-img-up").onclick=ot,o.querySelector(".button-img-down").onclick=at,o.querySelector(".button-img-random").onclick=it,G[n]=o}}(),function(){for(const t of G){const e=t.querySelector(".talent-dropdown");St(e),document.addEventListener("click",(t=>{Rt(t,e)})),document.addEventListener("keydown",(t=>{At(t,e)}))}}()}function lt(t){!function(t){const e=J[W(t)];t.querySelector(".talent-select-image").style.setProperty("--image-url",`url(images/talents/${e}-medium.webp)`)}(t),function(t){t.querySelector(".talent-select-name__name").innerHTML=(0,a.getFullNameStringById)(J[W(t)])}(t),function(t){!function(t){for(const e of t.querySelectorAll(".talent-dropdown-entries__entry"))e.classList.remove("talent-dropdown-entries__entry--highlighted")}(t.querySelector(".talent-dropdown"));const e=wt(t);n=e,n.classList.add("talent-dropdown-entries__entry--highlighted"),bt(e);var n}(t)}function ht(){const e=t(".result-canvas");var n;(n=e).style.animation="none",n.offsetHeight,n.style.animation=null,async function(t,e,n,o){const a=++M,r=t.getContext("2d");var i;(i=t).getContext("2d").clearRect(0,0,i.width,i.height);const s=await O(e,n,o);if(M!==a)return;x(t);const{width:c,height:f}=w(t.width,t.height,s.width,s.height);r.drawImage(s,p(t.width,c,.5),p(t.height,f,1),c,f)}(e,...Z(),F[K])}function yt(){!function(){const[e,n]=Z(),o=(0,a.getFusionStringByIds)(e,n);t(".result-name").innerHTML=o,t(".result-name-copy").innerHTML=o}(),ht()}function gt(){!function(){for(const t of G)lt(t)}(),yt()}const mt=[".talent-dropdown",".talent-select-button-imgs",".talent-select-name",".talent-select-image"];function bt(t){const e=t.closest(".talent-dropdown-entries"),n=t.offsetTop-e.offsetHeight/2+t.offsetHeight/2;e.scrollTop=n}function wt(t){return function(t,e){return t.querySelector(`[data-talent-index="${e}"]`)}(t,W(tt(t)))}function pt(t){!function(t){for(const e of mt)t.querySelector(e).classList.add("dropdown-visible")}(t),bt(wt(t.querySelector(".talent-dropdown")))}function xt(t){!function(t){for(const e of mt)t.querySelector(e).classList.remove("dropdown-visible")}(t)}function kt(t){if(0!==t.button)return;const e=t.currentTarget,n=tt(e);Q(n,e.dataset.talentIndex),xt(n),gt()}function Ct(t){return t.querySelector(".talent-dropdown").classList.contains("dropdown-visible")}function It(t){const e=tt(t.target);Ct(e)||(pt(e),t.ifDropdownElementJustShown=e.querySelector(".talent-dropdown"))}function Lt(n,o,r){const i=e(t(".template-talent-dropdown-entry"));i.querySelector(".talent-dropdown-entries__entry__image").style.setProperty("--image-url",`url(images/talents/${r}-small.webp)`);const s=(0,a.getFullNameStringById)(r);i.querySelector(".talent-dropdown-entries__entry__name").innerHTML=s,n.querySelector(".talent-dropdown-entries").appendChild(i);const c=n.querySelector(".talent-dropdown-entries").lastElementChild;c.dataset.talentIndex=o,c.onclick=kt,c.onmouseup=kt}function St(t){for(let e=0;e<J.length;e++)Lt(t,e,J[e])}function Rt(t,e){t.ifDropdownElementJustShown!==e&&xt(tt(e))}function At(t,e){const n=tt(e);if(!Ct(n))return;const o={ArrowUp:()=>{et(n)},ArrowDown:()=>{nt(n)},Enter:()=>{xt(n)},Escape:()=>{xt(n)}};o[t.key]&&(o[t.key](),t.preventDefault())}dt(),function(){const e=t(".result-box");e.querySelector(".button-img-random").onclick=st,e.querySelector(".button-img-swap").onclick=ct;const n=e.querySelector(".button-img-unitinu-container");n.onclick=ut,ft(n,F[K])}(),H(),$(),st(),function(){const t=new URLSearchParams(window.location.search);t.get("f")&&J.indexOf(t.get("f"))>=0&&Q(G[0],J.indexOf(t.get("f"))),t.get("s")&&J.indexOf(t.get("s"))>=0&&Q(G[1],J.indexOf(t.get("s"))),gt()}()})()})();